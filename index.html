<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Audit Form</title>
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<style>
body { font-family: Arial; margin: 20px; background:#f4f4f4; }
form { background: white; padding:20px; border-radius:10px; max-width:600px; margin:auto; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
label { display:block; margin-top:10px; font-weight:bold; }
input, select, button { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
button { background:#007bff; color:white; font-weight:bold; cursor:pointer; }
button:hover { background:#0056b3; }
.camera-btn { display:flex; align-items:center; }
.camera-btn input { width:85%; }
.camera-btn button { width:12%; padding:8px; background:#28a745; border:none; cursor:pointer; color:white; }
#suggestions { border:1px solid #ccc; max-height:150px; overflow-y:auto; position:absolute; background:#fff; z-index:10; width:95%; }
#suggestions div { padding:8px; cursor:pointer; }
#suggestions div:hover { background:#f0f0f0; }
#qr-reader { width:100%; margin-top:10px; display:none; }
</style>
</head>
<body>

<form id="auditForm">
  <h2>Audit Form</h2>

  <!-- DH Name -->
  <label for="dhName">DH Name *</label>
  <input type="text" id="dhName" required autocomplete="off">
  <div id="suggestions"></div>

  <!-- LPN Number -->
  <label for="lpnNumber">LPN Number *</label>
  <div class="camera-btn">
    <input type="text" id="lpnNumber" required>
    <button type="button" onclick="startScanner()">ðŸ“· Scan</button>
  </div>
  <div id="qr-reader"></div>

  <!-- LPN Qty -->
  <label for="lpnQty">LPN Qty *</label>
  <input type="number" id="lpnQty" required>

  <!-- Physical Qty -->
  <label for="physicalQty">Physical Qty *</label>
  <input type="number" id="physicalQty" required>

  <!-- Type -->
  <label for="type">Type *</label>
  <select id="type" required>
    <option value="">Select</option>
    <option>QC</option>
    <option>Non QC</option>
  </select>

  <!-- Auditor Name -->
  <label for="auditorName">Auditor Name *</label>
  <select id="auditorName" required>
    <option value="">Select</option>
    <option>Arjun MY</option>
    <option>Kishor Pandit</option>
    <option>Jeet Kumar</option>
    <option>Sagar Pandit</option>
  </select>

  <!-- Remarks -->
  <label for="remarks">Remarks *</label>
  <select id="remarks" required>
    <option value="">Select</option>
    <option>Short</option>
    <option>Damage</option>
    <option>Excess</option>
    <option>Miss match</option>
    <option>No issue</option>
  </select>

  <!-- Different Qty -->
  <label for="differentQty">Different Qty *</label>
  <input type="number" id="differentQty" required>

  <!-- Different Value -->
  <label for="differentValue">Different Value *</label>
  <input type="number" id="differentValue" required>

  <!-- Employee Name (optional) -->
  <label for="employeeName">Employee Name</label>
  <input type="text" id="employeeName">

  <button type="submit">Submit</button>
  <button type="button" onclick="document.getElementById('auditForm').reset()">Clear Form</button>
</form>

  <script>
const SCRIPT_URL = "YOUR_WEB_APP_URL"; // Replace with your Apps Script Web App URL

// DH Names array
const dhNames = ["BLR-BTM-2","BLR-BTM LAYOUT NEW","BLR-RICHMOND TOWN","BLR-JP Nagar","BLR-BANASHANKARI","BLR-Mathikere","BLR-Kalyan Nagar Network","BLR-Chickpet New","BLR-SHIVAJI NAGAR","BLR-Cholayakanakalli","BLR-Jakkur New","BLR-Jakkur Network","BLR-HEBBAL NEW","BLR-Nikoo Home New","BLR-TC Palaya","BLR-Devanahalli","BLR-Yelahanka Network","BLR-Nehru Nagar","BLR-GUNJUR","BLR-HSR-3","BLR-Narayana reddy Layout","BLR-Kannika Nagar","BLR-GUNJUR Network","BLR-Mico layout network-2","BLR-Bannerghatta Network 2","BLR-BANNERGHATTA","BLR-Kambhipura","BLR-JP NAGAR New","BLR-KALYAN NAGAR NEW","BLR-Challakere","BLR-Koramangala Network","BLR-Hennur New","BLR-Dasarahalli","BLR-SHIVAJI NAGAR Network","BLR-Margosa road","BLR-Banjara Layout","BLR-Ramamurthy Nagar Network","BLR-BASAVANAPURA NETWORK 2","BLR-Bagalur","BLR-RWF Yelahanka","Sanjaynagar","BLR-BHADRAPPA LAYOUT NETWORK","BLR-Bhadrapppa Layout","BLR-HBR Layout","BLR-Dooravani Nagar","BLR-Nagavara","BLR-Narayanapura","BLR-YELAHANKA","BLR-Kasturinagar","BLR-Vidyaranyapura","BLR-Kogilu Road","BLR-Narayanapura Network","BLR-INDIRANAGAR NEW","BLR-Malleshwaram new","BLR-RAMAMURTHY NAGAR NEW"];

const dhInput = document.getElementById("dhName");
const suggestions = document.getElementById("suggestions");

dhInput.addEventListener("input", () => {
  const val = dhInput.value.toLowerCase();
  suggestions.innerHTML = "";
  if (val) {
    dhNames.filter(n => n.toLowerCase().includes(val)).forEach(n => {
      const div = document.createElement("div");
      div.textContent = n;
      div.onclick = () => { dhInput.value = n; suggestions.innerHTML = ""; };
      suggestions.appendChild(div);
    });
  }
});
document.addEventListener("click", e => { if (e.target !== dhInput) suggestions.innerHTML = ""; });

// QR + Barcode Scanner
function startScanner() {
  const readerDiv = document.getElementById("qr-reader");
  readerDiv.style.display = "block";
  const html5QrCode = new Html5Qrcode("qr-reader");
  const config = {
    fps: 10,
    qrbox: 250,
    formatsToSupport: [
      Html5QrcodeSupportedFormats.QR_CODE,
      Html5QrcodeSupportedFormats.CODE_128,
      Html5QrcodeSupportedFormats.CODE_39,
      Html5QrcodeSupportedFormats.EAN_13,
      Html5QrcodeSupportedFormats.EAN_8,
      Html5QrcodeSupportedFormats.DATA_MATRIX,
      Html5QrcodeSupportedFormats.PDF_417,
      Html5QrcodeSupportedFormats.AZTEC
    ]
  };

  html5QrCode.start(
    { facingMode: "environment" },
    config,
    qrCodeMessage => {
      document.getElementById("lpnNumber").value = qrCodeMessage;
      html5QrCode.stop().then(() => { readerDiv.style.display = "none"; });
    },
    err => { console.log("Decode error:", err); }
  ).catch(err => { console.error("Scanner start error:", err); });
}

// Form submit
document.getElementById("auditForm").addEventListener("submit", e => {
  e.preventDefault();
  const formData = {
    dhName: dhInput.value,
    lpnNumber: document.getElementById("lpnNumber").value,
    lpnQty: document.getElementById("lpnQty").value,
    physicalQty: document.getElementById("physicalQty").value,
    type: document.getElementById("type").value,
    auditorName: document.getElementById("auditorName").value,
    remarks: document.getElementById("remarks").value,
    differentQty: document.getElementById("differentQty").value,
    differentValue: document.getElementById("differentValue").value,
    employeeName: document.getElementById("employeeName").value
  };
  fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(formData) })
    .then(res => res.json())
    .then(() => { alert("Form submitted successfully!"); document.getElementById("auditForm").reset(); })
    .catch(err => alert("Error submitting form: " + err));
});
  </script>

</body>
</html>
